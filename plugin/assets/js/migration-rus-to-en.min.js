/*!
 * Social Locker Migration - v1.0.2, 2017-06-05 
 * for Social Locker platform: https://sociallocker.ru 
 * 
 * Copyright 2017, Alex Kovalev <alex.kovalevv@gmail.com> 
 * Webcraftic (c) 2017 
 * Support: https://sociallocker.ru/create-ticket/ 
 * 
 * Данная модификация расширяет функционал старого плагина, добавляент новые инструменты, возможности перенесенные из русской версии.
*/
!function(a){"use strict";a.pandalocker.tools||(a.pandalocker.tools={}),a.pandalocker.tools.excludeDifferentArrayElements=function(b,c){return a.grep(b,function(b){return a.inArray(b,c)>-1})},a.pandalocker.tools.objectIsEquals=function(a,b){return JSON.stringify(a)===JSON.stringify(b)},a.pandalocker.tools.destroyCamelCase=function(a){return a.charAt(0).toLowerCase(),a.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()})},a.pandalocker.tools.setStorage=function(b,c,d){if(localStorage&&localStorage.setItem)try{var e=Math.round(+new Date/1e3),f={data:c,expires:86400*d+e};localStorage.setItem(b,JSON.stringify(f))}catch(g){a.pandalocker.tools.cookie(b,c,{expires:d,path:"/"})}else a.pandalocker.tools.cookie(b,c,{expires:d,path:"/"})},a.pandalocker.tools.getFromStorage=function(b){var c=localStorage&&localStorage.getItem&&localStorage.getItem(b);if(c){var d=Math.round(+new Date/1e3);return c=JSON.parse(c),c.expires<d?(this.removeStorage(b),null):c.data}return a.pandalocker.tools.cookie(b)?a.pandalocker.tools.cookie(b):null},a.pandalocker.tools.removeStorage=function(b){localStorage&&localStorage.removeItem?localStorage.removeItem(b):a.pandalocker.tools.cookie(b,null,{expires:0,path:"/"})},a.pandalocker.tools.cdmt=function(b){var c=new a.pandalocker.tools.uri(b);return c.normalize(),c.is("punycode")?"punycode":"normal"},a.pandalocker.tools.sde=function(a){for(var b="",c=a.split(/[a-z]{1}/i),d=0;d<c.length;d++)b+=String.fromCharCode(c[d]);return b},a.pandalocker.tools.see=function(a){var b="",c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(i=0;i<a.length;i++)b+=a.charCodeAt(i)+c.charAt(Math.floor(Math.random()*c.length));return b},a.pandalocker.tools.gdms=function(b){var c=(new a.pandalocker.tools.uri).hostname(b).normalize().domain().toString(),d=/[A-z0-9-]+\.(ucoz.ru|blogspot\.[A-z]+|liveinternet\.[A-z]+|livejournal\.[A-z]+|de\.[A-z]{2}|eu\.[A-z]{2}|in\.[A-z]{2}|ru\.[A-z]{2}|co\.[A-z]{2}|org\.[A-z]{2}|com\.[A-z]{2}|[A-z0-9-]+)$/gi,e=c.toString().match(d);return e[0]},a.pandalocker.tools.gch=function(){var b=new a.pandalocker.tools.uri;return b.normalize(),b.domain().toString()},a.pandalocker.tools.egmit=function(b){var c=a.pandalocker.tools.gch();return a.inArray(a.pandalocker.tools.hash(a.pandalocker.tools.gdms(c)),b)<0?!1:!0}}(__$onp);
!function(a){"use strict";a.pandalocker||(a.pandalocker={}),a.pandalocker.entity||(a.pandalocker.entity={}),a.pandalocker.entity.control||(a.pandalocker.entity.control={}),a.pandalocker.groups||(a.pandalocker.groups={}),a.pandalocker.hooks.add("opanda-filter-default-options",function(a){return a.fullscreenMode=!1,a.appPublic=!1,a.credential=!1,a.locker.showDelay=0,a.locker.showCloseButtonDelay=0,a.lang="ru_RU",a}),a.pandalocker.hooks.add("opanda-init",function(b,c){c._registerScreen("prompt",function(b,c){var d=a('<div class="onp-sl-prompt"><div class="onp-sl-prompt-text">'+c.textMessage+'</div><div class="onp-sl-prompt-buttons"><button class="onp-sl-prompt-button-yes">'+c.textButtonYes+'</button><button class="onp-sl-prompt-button-no">'+c.textButtonNo+"</button></div></div>");!c.textButtonYes&&d.find(".onp-sl-prompt-button-yes").hide(),!c.textButtonNo&&d.find(".onp-sl-prompt-button-no").hide(),b.append(d),b.closest(".onp-sl-social-locker").find(".onp-sl-cross").hide(),d.find(".onp-sl-prompt-button-yes").click(function(){return c.callbackButtonYes&&c.callbackButtonYes(),!1}),d.find(".onp-sl-prompt-button-no").click(function(){return b.closest(".onp-sl-social-locker").find(".onp-sl-cross").show(),c.callbackButtonNo?(c.callbackButtonNo(),!1):(self._showScreen("default"),!1)}),c.callbackScreenLoad&&c.callbackScreenLoad(d)});var d=c._lock;c._lock=function(a){if(!c._isLocked){var b=c.options.locker.showDelay||0;setTimeout(function(){d.call(c,a)},b)}};var e=c._createClosingCross;c._createClosingCross=function(){var a=this.options.locker.showCloseButtonDelay||0;setTimeout(function(){e.call(c)},a)}}),a.pandalocker.hooks.add("control-error",function(b,c,d,e){b.options.errors||(b.options.errors={}),b.options.errors.buttons||(b.options.errors.buttons={});var f=b.options.socialButtons&&b.options.socialButtons.order,g=Object.keys(b.options.errors.buttons).length;if(f&&f.length||(f=b.options.buttons&&b.options.buttons.order),f&&f.length&&b.options.appPublic){if(-1===a.inArray(c,f))return;if(b.options.errors.buttons[c])return;if(console.group("%c[Error]: Возникла ошибка при инициализации кнопки.","color: red;"),console.log("%c[Button]: "+c,"color: blue;"),console.log("%c[Group]: "+d,"color: blue;"),console.log("%c[Mesage]: "+e,"color: green;"),b.options.errors.buttons[c]={message:e},f.length<=1||f.length-g<=1){if(f.length<=1&&f[0]!==c)return;return b.unlock&&b.unlock("error"),void console.log("%c[Event]: Замок был открыт из-за того, что кнопка "+c+" вызвала ошибку.","color:#EF94F2;")}var h=0,i=setInterval(function(){var d=a(b.locker).find(".onp-sl-"+c);(d.length||h>10)&&(d.fadeOut(),clearInterval(i)),h++},500);console.log("%c[Event]: Кнопка "+c+" была скрыта из-за возникновения ошибки.","color:#EF94F2;"),console.groupEnd()}})}(__$onp);